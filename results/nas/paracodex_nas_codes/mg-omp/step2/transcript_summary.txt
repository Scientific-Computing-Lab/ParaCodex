Fused the two-pass stencils to cut kernel launches and device temp traffic while keeping the persistent data mapping unchanged. Key changes are in `mg.c:392-417` and `mg.c:432-470`, where `psinv` and `resid` now compute neighbor sums in-register inside a single `target teams loop`, dropped the device `map(alloc)` temporaries, and added `__restrict__` qualifiers. This removes per-call malloc/free and one launch per call for both hot kernels, plus trims extra synchronizations.

Results (Class B, RTX 4060):
- Runtime improved from 0.57s → 0.53s (~1.08×).
- Kernel launches down to 2983 (was 3321); stream syncs to 3281 (was 3957).
- Main kernel is the fused `resid` (~50.9% GPU time, 170 instances); `psinv` now single-pass.
- Mem copies unchanged (10 D2H totalling ~178 ms); further gains would need reducing these transfers.

Tests run:
- `make clean`
- `timeout 300 env OMP_TARGET_OFFLOAD=MANDATORY make CC=nvc++ CLASS=A run` (verification successful)
- `make clean`
- `env OMP_TARGET_OFFLOAD=MANDATORY nsys profile --stats=true --trace=cuda,osrt --force-overwrite=true -o nsys_profile make CC=nvc++ CLASS=B run` (metrics captured in `profile.log`)

Updated `optimization_plan.md` with current metrics, actions, and final summary. Next steps if desired: (1) investigate why 10 D2H copies are issued despite persistent mappings—eliminate redundant host-visible reductions/copies; (2) consider minor tuning of teams/thread limits or simd hints for `resid` once transfer overhead is addressed.