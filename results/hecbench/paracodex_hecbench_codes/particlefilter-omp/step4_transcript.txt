- Introduced precomputed grid strides and reciprocal constants in `main.cpp:239-247` so the kernels reuse invariant math (invParticles, invCountOnes, invM, slice/frame strides) without re-deriving them per thread.
- Reworked the hot propagation kernel in `main.cpp:297-352` to keep particle state in registers, reuse a local RNG stream, fuse index generation with likelihood accumulation, and write back once; this removes the second pass over `ind`/`I` and cuts global memory traffic while preserving the original math.
- Swapped the resampling scan for a lower-branch binary search in `main.cpp:411-428`, giving each particle logarithmic lookup of its ancestor without changing the “first CDF ≥ u” selection.

Build: `make -f Makefile.nvc clean` → `make -f Makefile.nvc`

Next step: run the provided Nsight Compute command (`ncu --target-processes all --section "SpeedOfLight" --launch-count 4 make -f Makefile.nvc run`) to confirm the latency and throughput gains.