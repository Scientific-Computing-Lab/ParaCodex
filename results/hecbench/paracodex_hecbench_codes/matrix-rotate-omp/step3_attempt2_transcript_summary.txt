**Kernel Tuning**
- `main.cpp:1-5` now includes `<algorithm>` so we can rely on `std::min/std::max` for deriving launch bounds without rolling our own helpers.
- `main.cpp:11-20` replaces the ad-hoc team selection with a hardware-aware heuristic: it derives required teams from the actual work items, enforces at least six waves per the RTX 4060 Laptop GPU’s 24 SM Ada architecture, and caps the hint at twice the 2048-thread-per-SM concurrency to avoid excessive launch overhead while still providing back-to-back waves.
- `main.cpp:27` adds `schedule(static,1)` to the collapsed `(layer, idx)` loop so the teams/threads map evenly across the expanded iteration space, which keeps the GPU saturated once the tuned `num_teams(..)`/`thread_limit(..)` hints kick in.

**Next steps**
1. `cd /root/codex_baseline/cuda_omp_workdir/data/src/matrix-rotate-omp && make -f Makefile.nvc clean && make -f Makefile.nvc`
2. `FORCE_OMP_GPU=1 OMP_TARGET_OFFLOAD=MANDATORY nsys profile --stats=true --trace=cuda,osrt --force-overwrite=true -o nsys_profile make -f Makefile.nvc run`

Let me know if you’d like me to inspect the new nsys report or push the tuning further.