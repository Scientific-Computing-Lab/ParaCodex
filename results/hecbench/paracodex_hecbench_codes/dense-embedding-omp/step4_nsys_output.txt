./main 2000 2 1
Number of rows in the embedding table: 2000
Batch size: 2

Embedding dimension: 768
block size: 128
Average execution time of dense embedding kernel (k1): 235.807007 (us)
Average execution time of dense embedding kernel (k2): 674.035034 (us)
PASS
block size: 256
Average execution time of dense embedding kernel (k1): 946.655029 (us)
Average execution time of dense embedding kernel (k2): 126.487007 (us)
PASS
block size: 512
Average execution time of dense embedding kernel (k1): 210.018005 (us)
Average execution time of dense embedding kernel (k2): 408.081024 (us)
PASS
block size: 1024
Average execution time of dense embedding kernel (k1): 490.641022 (us)
Average execution time of dense embedding kernel (k2): 446.443024 (us)
PASS
GATE:STAT name=output_ref_dim768 dtype=f32 n=1536000 min=-1.9288528 max=1.97934711 mean=1.38237755e-05 L1=21.2333191 L2=45.7497117

Embedding dimension: 2048
block size: 128
Average execution time of dense embedding kernel (k1): 84.325005 (us)
Average execution time of dense embedding kernel (k2): 76.009003 (us)
PASS
block size: 256
Average execution time of dense embedding kernel (k1): 243.387009 (us)
Average execution time of dense embedding kernel (k2): 140.986008 (us)
PASS
block size: 512
Average execution time of dense embedding kernel (k1): 192.544006 (us)
Average execution time of dense embedding kernel (k2): 129.122009 (us)
PASS
block size: 1024
Average execution time of dense embedding kernel (k1): 199.560013 (us)
Average execution time of dense embedding kernel (k2): 188.463013 (us)
PASS
GATE:STAT name=output_ref_dim2048 dtype=f32 n=4096000 min=-1.95189083 max=1.98709643 mean=1.12630404e-05 L1=46.1334136 L2=73.9882018

Embedding dimension: 12288
block size: 128
Average execution time of dense embedding kernel (k1): 127.187004 (us)
Average execution time of dense embedding kernel (k2): 164.039001 (us)
PASS
block size: 256
Average execution time of dense embedding kernel (k1): 333.315002 (us)
Average execution time of dense embedding kernel (k2): 118.385002 (us)
PASS
block size: 512
Average execution time of dense embedding kernel (k1): 218.802017 (us)
Average execution time of dense embedding kernel (k2): 85.686005 (us)
PASS
block size: 1024
Average execution time of dense embedding kernel (k1): 234.489014 (us)
Average execution time of dense embedding kernel (k2): 95.336006 (us)
PASS
GATE:STAT name=output_ref_dim12288 dtype=f32 n=24576000 min=-1.98780847 max=1.991997 mean=2.41744846e-06 L1=59.4112133 L2=180.699713
Collecting data...
Generating '/tmp/nsys-report-aa17.qdstrm'

[1/7] [0%                          ] nsys_profile.nsys-rep
[1/7] [0%                          ] nsys_profile.nsys-rep
[1/7] [==19%                       ] nsys_profile.nsys-rep
[1/7] [==20%                       ] nsys_profile.nsys-rep
[1/7] [==21%                       ] nsys_profile.nsys-rep
[1/7] [===24%                      ] nsys_profile.nsys-rep
[1/7] [====27%                     ] nsys_profile.nsys-rep
[1/7] [====28%                     ] nsys_profile.nsys-rep
[1/7] [=====30%                    ] nsys_profile.nsys-rep
[1/7] [=====31%                    ] nsys_profile.nsys-rep
[1/7] [=====32%                    ] nsys_profile.nsys-rep
[1/7] [======33%                   ] nsys_profile.nsys-rep
[1/7] [======34%                   ] nsys_profile.nsys-rep
[1/7] [=======37%                  ] nsys_profile.nsys-rep
[1/7] [==========48%               ] nsys_profile.nsys-rep
[1/7] [==================75%       ] nsys_profile.nsys-rep
[1/7] [========================100%] nsys_profile.nsys-rep
[1/7] [========================100%] nsys_profile.nsys-rep

[2/7] [0%                          ] nsys_profile.sqlite
[2/7] [1%                          ] nsys_profile.sqlite
[2/7] [2%                          ] nsys_profile.sqlite
[2/7] [3%                          ] nsys_profile.sqlite
[2/7] [4%                          ] nsys_profile.sqlite
[2/7] [5%                          ] nsys_profile.sqlite
[2/7] [6%                          ] nsys_profile.sqlite
[2/7] [7%                          ] nsys_profile.sqlite
[2/7] [8%                          ] nsys_profile.sqlite
[2/7] [9%                          ] nsys_profile.sqlite
[2/7] [10%                         ] nsys_profile.sqlite
[2/7] [11%                         ] nsys_profile.sqlite
[2/7] [12%                         ] nsys_profile.sqlite
[2/7] [13%                         ] nsys_profile.sqlite
[2/7] [14%                         ] nsys_profile.sqlite
[2/7] [=15%                        ] nsys_profile.sqlite
[2/7] [=16%                        ] nsys_profile.sqlite
[2/7] [=17%                        ] nsys_profile.sqlite
[2/7] [==18%                       ] nsys_profile.sqlite
[2/7] [==19%                       ] nsys_profile.sqlite
[2/7] [==20%                       ] nsys_profile.sqlite
[2/7] [==21%                       ] nsys_profile.sqlite
[2/7] [===22%                      ] nsys_profile.sqlite
[2/7] [===23%                      ] nsys_profile.sqlite
[2/7] [===24%                      ] nsys_profile.sqlite
[2/7] [====25%                     ] nsys_profile.sqlite
[2/7] [====26%                     ] nsys_profile.sqlite
[2/7] [====27%                     ] nsys_profile.sqlite
[2/7] [====28%                     ] nsys_profile.sqlite
[2/7] [=====29%                    ] nsys_profile.sqlite
[2/7] [=====30%                    ] nsys_profile.sqlite
[2/7] [=====31%                    ] nsys_profile.sqlite
[2/7] [=====32%                    ] nsys_profile.sqlite
[2/7] [======33%                   ] nsys_profile.sqlite
[2/7] [======34%                   ] nsys_profile.sqlite
[2/7] [======35%                   ] nsys_profile.sqlite
[2/7] [=======36%                  ] nsys_profile.sqlite
[2/7] [=======37%                  ] nsys_profile.sqlite
[2/7] [=======38%                  ] nsys_profile.sqlite
[2/7] [=======39%                  ] nsys_profile.sqlite
[2/7] [========40%                 ] nsys_profile.sqlite
[2/7] [========41%                 ] nsys_profile.sqlite
[2/7] [========42%                 ] nsys_profile.sqlite
[2/7] [=========43%                ] nsys_profile.sqlite
[2/7] [=========44%                ] nsys_profile.sqlite
[2/7] [=========45%                ] nsys_profile.sqlite
[2/7] [=========46%                ] nsys_profile.sqlite
[2/7] [==========47%               ] nsys_profile.sqlite
[2/7] [==========48%               ] nsys_profile.sqlite
[2/7] [==========49%               ] nsys_profile.sqlite
[2/7] [===========50%              ] nsys_profile.sqlite
[2/7] [===========51%              ] nsys_profile.sqlite
[2/7] [===========52%              ] nsys_profile.sqlite
[2/7] [===========53%              ] nsys_profile.sqlite
[2/7] [============54%             ] nsys_profile.sqlite
[2/7] [============55%             ] nsys_profile.sqlite
[2/7] [============56%             ] nsys_profile.sqlite
[2/7] [============57%             ] nsys_profile.sqlite
[2/7] [=============58%            ] nsys_profile.sqlite
[2/7] [=============59%            ] nsys_profile.sqlite
[2/7] [=============60%            ] nsys_profile.sqlite
[2/7] [==============61%           ] nsys_profile.sqlite
[2/7] [==============62%           ] nsys_profile.sqlite
[2/7] [==============63%           ] nsys_profile.sqlite
[2/7] [==============64%           ] nsys_profile.sqlite
[2/7] [===============65%          ] nsys_profile.sqlite
[2/7] [===============66%          ] nsys_profile.sqlite
[2/7] [===============67%          ] nsys_profile.sqlite
[2/7] [================68%         ] nsys_profile.sqlite
[2/7] [================69%         ] nsys_profile.sqlite
[2/7] [================70%         ] nsys_profile.sqlite
[2/7] [================71%         ] nsys_profile.sqlite
[2/7] [=================72%        ] nsys_profile.sqlite
[2/7] [=================73%        ] nsys_profile.sqlite
[2/7] [=================74%        ] nsys_profile.sqlite
[2/7] [==================75%       ] nsys_profile.sqlite
[2/7] [==================76%       ] nsys_profile.sqlite
[2/7] [==================77%       ] nsys_profile.sqlite
[2/7] [==================78%       ] nsys_profile.sqlite
[2/7] [===================79%      ] nsys_profile.sqlite
[2/7] [===================80%      ] nsys_profile.sqlite
[2/7] [===================81%      ] nsys_profile.sqlite
[2/7] [===================82%      ] nsys_profile.sqlite
[2/7] [====================83%     ] nsys_profile.sqlite
[2/7] [====================84%     ] nsys_profile.sqlite
[2/7] [====================85%     ] nsys_profile.sqlite
[2/7] [=====================86%    ] nsys_profile.sqlite
[2/7] [=====================87%    ] nsys_profile.sqlite
[2/7] [=====================88%    ] nsys_profile.sqlite
[2/7] [=====================89%    ] nsys_profile.sqlite
[2/7] [======================90%   ] nsys_profile.sqlite
[2/7] [======================91%   ] nsys_profile.sqlite
[2/7] [======================92%   ] nsys_profile.sqlite
[2/7] [=======================93%  ] nsys_profile.sqlite
[2/7] [=======================94%  ] nsys_profile.sqlite
[2/7] [=======================95%  ] nsys_profile.sqlite
[2/7] [=======================96%  ] nsys_profile.sqlite
[2/7] [========================97% ] nsys_profile.sqlite
[2/7] [========================98% ] nsys_profile.sqlite
[2/7] [========================99% ] nsys_profile.sqlite
[2/7] [========================100%] nsys_profile.sqlite
[2/7] [========================100%] nsys_profile.sqlite
[3/7] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)           Name         
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------
     58.1       1361279802          1  1361279802.0  1361279802.0  1361279802  1361279802          0.0  wait                  
     34.2        802322246         12    66860187.2    82984879.0        2321   100383181   39332863.9  poll                  
      5.1        118906520       1950       60977.7        3517.5        1010     7265400     350706.5  ioctl                 
      2.3         53711972          4    13427993.0    11609252.0      363787    30129681   15322241.9  fread                 
      0.1          2391059          8      298882.4      103085.5        2360     1612100     545838.3  read                  
      0.1          1759394         25       70375.8        3481.0        1058     1155749     242442.9  fopen                 
      0.1          1343839         60       22397.3       14576.5        1989      255719      36744.8  mprotect              
      0.0           515687         24       21487.0       13898.5        3642      111267      24606.6  mmap                  
      0.0           378255         13       29096.5        1446.0        1004      268830      73511.6  fclose                
      0.0           370121          3      123373.7      104770.0       98744      166607      37562.2  pthread_create        
      0.0           224939          2      112469.5      112469.5       58200      166739      76748.7  sem_timedwait         
      0.0           208305          1      208305.0      208305.0      208305      208305          0.0  posix_spawn           
      0.0           174494          1      174494.0      174494.0      174494      174494          0.0  pthread_cond_wait     
      0.0           172258          3       57419.3       35934.0       32026      104298      40645.1  fflush                
      0.0           170464          1      170464.0      170464.0      170464      170464          0.0  pthread_join          
      0.0            62730          4       15682.5       17975.0        1446       25334      10360.5  write                 
      0.0            58279          8        7284.9        6199.0        1192       15563       4130.2  open                  
      0.0            28184          1       28184.0       28184.0       28184       28184          0.0  fgets                 
      0.0            27393          1       27393.0       27393.0       27393       27393          0.0  pthread_cond_broadcast
      0.0            17802          3        5934.0        7693.0        2127        7982       3300.1  pipe2                 
      0.0            16238          1       16238.0       16238.0       16238       16238          0.0  fputs                 
      0.0            14611          6        2435.2        1963.0        1092        6152       1890.5  stat                  
      0.0             7924          4        1981.0        1425.0        1323        3751       1181.0  close                 
      0.0             6676          2        3338.0        3338.0        2632        4044        998.4  fwrite                
      0.0             6320          4        1580.0        1574.0        1400        1772        160.8  fcntl                 
      0.0             1281          1        1281.0        1281.0        1281        1281          0.0  sigaction             

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)          Name        
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  --------------------
     57.2        110217867         27  4082143.2  2099860.0    689960  11110881    3458058.4  cuMemcpyDtoHAsync_v2
     20.4         39206137         24  1633589.0    29175.0      4158  10914317    3396293.1  cuMemcpyHtoDAsync_v2
      6.5         12479799         30   415993.3    77422.0     18124   9124147    1647840.1  cuLaunchKernel      
      5.6         10849414         16   678088.4   585673.0      5590   2980025     787014.1  cuMemAlloc_v2       
      4.5          8639375          1  8639375.0  8639375.0   8639375   8639375          0.0  cuMemAllocManaged   
      3.2          6080025         57   106667.1    18858.0      1969   3157986     420745.8  cuStreamSynchronize 
      1.5          2906003          1  2906003.0  2906003.0   2906003   2906003          0.0  cuModuleLoadDataEx  
      1.2          2218552          1  2218552.0  2218552.0   2218552   2218552          0.0  cuMemAllocHost_v2   
      0.0            24915          4     6228.8     4730.0      1532     13923       5778.5  cuCtxSetCurrent     
      0.0             2162          1     2162.0     2162.0      2162      2162          0.0  cuInit              

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                         Name                        
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ---------------------------------------------------
     91.5           796808          3  265602.7   61598.0     18271    716939     391468.6  nvkernel_main_F1L137_2                             
      4.0            34429         12    2869.1    2544.0      1727      5632       1188.0  nvkernel_main_F1L153_4                             
      3.5            30686         12    2557.2    2400.0      1696      4224        854.3  nvkernel_main_F1L177_6                             
      1.0             8799          3    2933.0    2560.0      2400      3839        788.7  nvkernel__Z9referenceIfEvPKT_S2_PS0_iiPKii_F1L35_14

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ----------------------------
     75.7        103485102     27  3832781.6  1621170.0    556592  10625139    3508537.0  [CUDA memcpy Device-to-Host]
     24.3         33201555     24  1383398.1     1999.0       352   8885284    2901902.0  [CUDA memcpy Host-to-Device]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
   1087.488     27    40.277    16.384     6.144    98.304       42.029  [CUDA memcpy Device-to-Host]
    362.738     24    15.114     0.016     0.000    98.304       32.589  [CUDA memcpy Host-to-Device]

Generated:
	/root/codex_baseline/cuda_omp_workdir/data/src/dense-embedding-omp/nsys_profile.nsys-rep
	/root/codex_baseline/cuda_omp_workdir/data/src/dense-embedding-omp/nsys_profile.sqlite