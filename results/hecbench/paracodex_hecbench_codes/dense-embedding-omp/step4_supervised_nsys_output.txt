./main 2000 2 1
Number of rows in the embedding table: 2000
Batch size: 2

Embedding dimension: 768
block size: 128
Average execution time of dense embedding kernel (k1): 48.837002 (us)
Average execution time of dense embedding kernel (k2): 58.545002 (us)
PASS
block size: 256
Average execution time of dense embedding kernel (k1): 101.760002 (us)
Average execution time of dense embedding kernel (k2): 56.688004 (us)
PASS
block size: 512
Average execution time of dense embedding kernel (k1): 73.791000 (us)
Average execution time of dense embedding kernel (k2): 188.191010 (us)
PASS
block size: 1024
Average execution time of dense embedding kernel (k1): 196.263016 (us)
Average execution time of dense embedding kernel (k2): 47.344002 (us)
PASS
GATE:STAT name=output_ref_dim768 dtype=f32 n=1536000 min=-1.9288528 max=1.97934711 mean=1.38237755e-05 L1=21.2333191 L2=45.7497117

Embedding dimension: 2048
block size: 128
Average execution time of dense embedding kernel (k1): 53.457001 (us)
Average execution time of dense embedding kernel (k2): 229.217010 (us)
PASS
block size: 256
Average execution time of dense embedding kernel (k1): 275.710022 (us)
Average execution time of dense embedding kernel (k2): 71.493004 (us)
PASS
block size: 512
Average execution time of dense embedding kernel (k1): 101.935005 (us)
Average execution time of dense embedding kernel (k2): 69.497002 (us)
PASS
block size: 1024
Average execution time of dense embedding kernel (k1): 131.523010 (us)
Average execution time of dense embedding kernel (k2): 155.070007 (us)
PASS
GATE:STAT name=output_ref_dim2048 dtype=f32 n=4096000 min=-1.95189083 max=1.98709643 mean=1.12630404e-05 L1=46.1334136 L2=73.9882018

Embedding dimension: 12288
block size: 128
Average execution time of dense embedding kernel (k1): 135.352005 (us)
Average execution time of dense embedding kernel (k2): 129.851013 (us)
PASS
block size: 256
Average execution time of dense embedding kernel (k1): 290.608002 (us)
Average execution time of dense embedding kernel (k2): 138.078003 (us)
PASS
block size: 512
Average execution time of dense embedding kernel (k1): 263.709015 (us)
Average execution time of dense embedding kernel (k2): 154.466003 (us)
PASS
block size: 1024
Average execution time of dense embedding kernel (k1): 244.521011 (us)
Average execution time of dense embedding kernel (k2): 255.237015 (us)
PASS
GATE:STAT name=output_ref_dim12288 dtype=f32 n=24576000 min=-1.98780847 max=1.991997 mean=2.41744846e-06 L1=59.4112133 L2=180.699713
Collecting data...
Generating '/tmp/nsys-report-ebe6.qdstrm'

[1/7] [0%                          ] nsys_profile.nsys-rep
[1/7] [0%                          ] nsys_profile.nsys-rep
[1/7] [=17%                        ] nsys_profile.nsys-rep
[1/7] [==19%                       ] nsys_profile.nsys-rep
[1/7] [==21%                       ] nsys_profile.nsys-rep
[1/7] [===23%                      ] nsys_profile.nsys-rep
[1/7] [====26%                     ] nsys_profile.nsys-rep
[1/7] [====27%                     ] nsys_profile.nsys-rep
[1/7] [====28%                     ] nsys_profile.nsys-rep
[1/7] [=====29%                    ] nsys_profile.nsys-rep
[1/7] [=====30%                    ] nsys_profile.nsys-rep
[1/7] [=====31%                    ] nsys_profile.nsys-rep
[1/7] [======34%                   ] nsys_profile.nsys-rep
[1/7] [=========45%                ] nsys_profile.nsys-rep
[1/7] [=================73%        ] nsys_profile.nsys-rep
[1/7] [========================100%] nsys_profile.nsys-rep
[1/7] [========================100%] nsys_profile.nsys-rep

[2/7] [0%                          ] nsys_profile.sqlite
[2/7] [1%                          ] nsys_profile.sqlite
[2/7] [2%                          ] nsys_profile.sqlite
[2/7] [3%                          ] nsys_profile.sqlite
[2/7] [4%                          ] nsys_profile.sqlite
[2/7] [5%                          ] nsys_profile.sqlite
[2/7] [6%                          ] nsys_profile.sqlite
[2/7] [7%                          ] nsys_profile.sqlite
[2/7] [8%                          ] nsys_profile.sqlite
[2/7] [9%                          ] nsys_profile.sqlite
[2/7] [10%                         ] nsys_profile.sqlite
[2/7] [11%                         ] nsys_profile.sqlite
[2/7] [12%                         ] nsys_profile.sqlite
[2/7] [13%                         ] nsys_profile.sqlite
[2/7] [14%                         ] nsys_profile.sqlite
[2/7] [=15%                        ] nsys_profile.sqlite
[2/7] [=16%                        ] nsys_profile.sqlite
[2/7] [=17%                        ] nsys_profile.sqlite
[2/7] [==18%                       ] nsys_profile.sqlite
[2/7] [==19%                       ] nsys_profile.sqlite
[2/7] [==20%                       ] nsys_profile.sqlite
[2/7] [==21%                       ] nsys_profile.sqlite
[2/7] [===22%                      ] nsys_profile.sqlite
[2/7] [===23%                      ] nsys_profile.sqlite
[2/7] [===24%                      ] nsys_profile.sqlite
[2/7] [====25%                     ] nsys_profile.sqlite
[2/7] [====26%                     ] nsys_profile.sqlite
[2/7] [====27%                     ] nsys_profile.sqlite
[2/7] [====28%                     ] nsys_profile.sqlite
[2/7] [=====29%                    ] nsys_profile.sqlite
[2/7] [=====30%                    ] nsys_profile.sqlite
[2/7] [=====31%                    ] nsys_profile.sqlite
[2/7] [=====32%                    ] nsys_profile.sqlite
[2/7] [======33%                   ] nsys_profile.sqlite
[2/7] [======34%                   ] nsys_profile.sqlite
[2/7] [======35%                   ] nsys_profile.sqlite
[2/7] [=======36%                  ] nsys_profile.sqlite
[2/7] [=======37%                  ] nsys_profile.sqlite
[2/7] [=======38%                  ] nsys_profile.sqlite
[2/7] [=======39%                  ] nsys_profile.sqlite
[2/7] [========40%                 ] nsys_profile.sqlite
[2/7] [========41%                 ] nsys_profile.sqlite
[2/7] [========42%                 ] nsys_profile.sqlite
[2/7] [=========43%                ] nsys_profile.sqlite
[2/7] [=========44%                ] nsys_profile.sqlite
[2/7] [=========45%                ] nsys_profile.sqlite
[2/7] [=========46%                ] nsys_profile.sqlite
[2/7] [==========47%               ] nsys_profile.sqlite
[2/7] [==========48%               ] nsys_profile.sqlite
[2/7] [==========49%               ] nsys_profile.sqlite
[2/7] [===========50%              ] nsys_profile.sqlite
[2/7] [===========51%              ] nsys_profile.sqlite
[2/7] [===========52%              ] nsys_profile.sqlite
[2/7] [===========53%              ] nsys_profile.sqlite
[2/7] [============54%             ] nsys_profile.sqlite
[2/7] [============55%             ] nsys_profile.sqlite
[2/7] [============56%             ] nsys_profile.sqlite
[2/7] [============57%             ] nsys_profile.sqlite
[2/7] [=============58%            ] nsys_profile.sqlite
[2/7] [=============59%            ] nsys_profile.sqlite
[2/7] [=============60%            ] nsys_profile.sqlite
[2/7] [==============61%           ] nsys_profile.sqlite
[2/7] [==============62%           ] nsys_profile.sqlite
[2/7] [==============63%           ] nsys_profile.sqlite
[2/7] [==============64%           ] nsys_profile.sqlite
[2/7] [===============65%          ] nsys_profile.sqlite
[2/7] [===============66%          ] nsys_profile.sqlite
[2/7] [===============67%          ] nsys_profile.sqlite
[2/7] [================68%         ] nsys_profile.sqlite
[2/7] [================69%         ] nsys_profile.sqlite
[2/7] [================70%         ] nsys_profile.sqlite
[2/7] [================71%         ] nsys_profile.sqlite
[2/7] [=================72%        ] nsys_profile.sqlite
[2/7] [=================73%        ] nsys_profile.sqlite
[2/7] [=================74%        ] nsys_profile.sqlite
[2/7] [==================75%       ] nsys_profile.sqlite
[2/7] [==================76%       ] nsys_profile.sqlite
[2/7] [==================77%       ] nsys_profile.sqlite
[2/7] [==================78%       ] nsys_profile.sqlite
[2/7] [===================79%      ] nsys_profile.sqlite
[2/7] [===================80%      ] nsys_profile.sqlite
[2/7] [===================81%      ] nsys_profile.sqlite
[2/7] [===================82%      ] nsys_profile.sqlite
[2/7] [====================83%     ] nsys_profile.sqlite
[2/7] [====================84%     ] nsys_profile.sqlite
[2/7] [====================85%     ] nsys_profile.sqlite
[2/7] [=====================86%    ] nsys_profile.sqlite
[2/7] [=====================87%    ] nsys_profile.sqlite
[2/7] [=====================88%    ] nsys_profile.sqlite
[2/7] [=====================89%    ] nsys_profile.sqlite
[2/7] [======================90%   ] nsys_profile.sqlite
[2/7] [======================91%   ] nsys_profile.sqlite
[2/7] [======================92%   ] nsys_profile.sqlite
[2/7] [=======================93%  ] nsys_profile.sqlite
[2/7] [=======================94%  ] nsys_profile.sqlite
[2/7] [=======================95%  ] nsys_profile.sqlite
[2/7] [=======================96%  ] nsys_profile.sqlite
[2/7] [========================97% ] nsys_profile.sqlite
[2/7] [========================98% ] nsys_profile.sqlite
[2/7] [========================99% ] nsys_profile.sqlite
[2/7] [========================100%] nsys_profile.sqlite
[2/7] [========================100%] nsys_profile.sqlite
[3/7] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)           Name         
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------
     59.6       1094276392          1  1094276392.0  1094276392.0  1094276392  1094276392          0.0  wait                  
     32.7        601028583         10    60102858.3    82534938.0        1410   100259616   45938899.1  poll                  
      5.7        104208885       1918       54332.1        3490.5        1001    10209364     382113.6  ioctl                 
      1.7         30282607          4     7570651.8     5928358.5      611156    17814734    8433430.8  fread                 
      0.1          1579983         24       65832.6        2899.5        1051     1047822     224941.2  fopen                 
      0.1           983382          8      122922.8      103596.5        1033      311517     132589.9  read                  
      0.0           584517          3      194839.0      102023.0       64184      418310     194454.1  sem_timedwait         
      0.0           561760         60        9362.7        7823.5        2043       32460       7378.5  mprotect              
      0.0           452736         24       18864.0       10080.0        3330       68852      17513.9  mmap                  
      0.0           311354          3      103784.7       97671.0       85737      127946      21758.5  pthread_create        
      0.0           238579          5       47715.8       21133.0        1260      172752      70485.5  fclose                
      0.0           198230          1      198230.0      198230.0      198230      198230          0.0  posix_spawn           
      0.0           153420          1      153420.0      153420.0      153420      153420          0.0  pthread_join          
      0.0           104285          1      104285.0      104285.0      104285      104285          0.0  pthread_cond_wait     
      0.0            95899          3       31966.3       30812.0       30671       34416       2122.6  fflush                
      0.0            49036          8        6129.5        6406.0        1097       12366       3427.1  open                  
      0.0            44834          4       11208.5       13469.0        1065       16831       7389.3  write                 
      0.0            25714          1       25714.0       25714.0       25714       25714          0.0  fgets                 
      0.0            18755          1       18755.0       18755.0       18755       18755          0.0  fputs                 
      0.0            13360          1       13360.0       13360.0       13360       13360          0.0  pthread_cond_broadcast
      0.0            12318          5        2463.6        1658.0        1214        6410       2215.6  stat                  
      0.0             9904          2        4952.0        4952.0        4110        5794       1190.8  pipe2                 
      0.0             4099          2        2049.5        2049.5        1305        2794       1052.9  fwrite                
      0.0             3269          2        1634.5        1634.5        1493        1776        200.1  close                 
      0.0             3244          2        1622.0        1622.0        1601        1643         29.7  fcntl                 

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)          Name        
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  --------------------
     66.1        115379785         27  4273325.4  1564476.0    558981  12641101    4647886.6  cuMemcpyDtoHAsync_v2
     23.7         41379586         24  1724149.4    26228.0      5051  11544802    3695774.7  cuMemcpyHtoDAsync_v2
      3.7          6416168         16   401010.5   385979.5      5913   1283703     391680.1  cuMemAlloc_v2       
      3.4          5873382         57   103041.8    14937.0       781   3408344     453542.4  cuStreamSynchronize 
      0.9          1649510         30    54983.7    49397.5     18557    129520      26752.8  cuLaunchKernel      
      0.9          1558949          1  1558949.0  1558949.0   1558949   1558949          0.0  cuMemAllocManaged   
      0.9          1520880          1  1520880.0  1520880.0   1520880   1520880          0.0  cuMemAllocHost_v2   
      0.4           706659          1   706659.0   706659.0    706659    706659          0.0  cuModuleLoadDataEx  
      0.0             8353          4     2088.3     2152.0      1257      2792        651.1  cuCtxSetCurrent     
      0.0             1628          1     1628.0     1628.0      1628      1628          0.0  cuInit              

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                         Name                        
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ---------------------------------------------------
     92.9          1021119          3  340373.0   65248.0     18816    937055     517263.0  nvkernel_main_F1L137_2                             
      3.2            35200         12    2933.3    2736.0      1728      6080       1265.2  nvkernel_main_F1L153_4                             
      3.0            32928         12    2744.0    2399.5      1664      6272       1288.9  nvkernel_main_F1L177_6                             
      0.9             9536          3    3178.7    2720.0      2592      4224        907.5  nvkernel__Z9referenceIfEvPKT_S2_PS0_iiPKii_F1L35_14

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ----------------------------
     75.9        112255251     27  4157601.9  1440733.0    481791  12480177    4634868.2  [CUDA memcpy Device-to-Host]
     24.1         35573556     24  1482231.5     1968.0       352  10504499    3206413.1  [CUDA memcpy Host-to-Device]

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
   1087.488     27    40.277    16.384     6.144    98.304       42.029  [CUDA memcpy Device-to-Host]
    362.738     24    15.114     0.016     0.000    98.304       32.589  [CUDA memcpy Host-to-Device]

Generated:
	/root/codex_baseline/cuda_omp_workdir/data/src/dense-embedding-omp/nsys_profile.nsys-rep
	/root/codex_baseline/cuda_omp_workdir/data/src/dense-embedding-omp/nsys_profile.sqlite