./main 10000 8 1
==PROF== Connected to process 941113 (/root/codex_baseline/cuda_omp_workdir/data/src/dense-embedding-omp/main)
==PROF== Profiling "nvkernel__Z18zero_device_buff..." - 0 (1/4): 0%....50%....100% - 8 passes
==PROF== Profiling "nvkernel__Z23dense_embedding_..." - 1 (2/4): 0%....50%....100% - 8 passes
==PROF== Profiling "nvkernel__Z18zero_device_buff..." - 2 (3/4): 0%....50%....100% - 8 passes
==PROF== Profiling "nvkernel__Z23dense_embedding_..." - 3 (4/4): 0%....50%....100% - 8 passes
Number of rows in the embedding table: 10000
Batch size: 8

Embedding dimension: 768
block size: 128
Average execution time of dense embedding kernel (k1): 152220.796875 (us)
Average execution time of dense embedding kernel (k2): 156931.156250 (us)
FAIL
block size: 256
Average execution time of dense embedding kernel (k1): 237.891006 (us)
Average execution time of dense embedding kernel (k2): 128.419006 (us)
FAIL
block size: 512
Average execution time of dense embedding kernel (k1): 127.252007 (us)
Average execution time of dense embedding kernel (k2): 121.258003 (us)
FAIL
block size: 1024
Average execution time of dense embedding kernel (k1): 120.850006 (us)
Average execution time of dense embedding kernel (k2): 130.455002 (us)
FAIL
GATE:SUM name=output_k1_dim768 dtype=bytes algo=fnv1a64 value=bdaea84dae2dc442 nbytes=30720000
GATE:SUM name=output_k2_dim768 dtype=bytes algo=fnv1a64 value=bdaea84dae2dc442 nbytes=30720000
GATE:SUM name=output_ref_dim768 dtype=bytes algo=fnv1a64 value=44759aab278b7665 nbytes=30720000

Embedding dimension: 2048
block size: 128
Average execution time of dense embedding kernel (k1): 175.798004 (us)
Average execution time of dense embedding kernel (k2): 196.957016 (us)
FAIL
block size: 256
Average execution time of dense embedding kernel (k1): 191.149002 (us)
Average execution time of dense embedding kernel (k2): 193.456009 (us)
FAIL
block size: 512
Average execution time of dense embedding kernel (k1): 149.134003 (us)
Average execution time of dense embedding kernel (k2): 215.302017 (us)
FAIL
block size: 1024
Average execution time of dense embedding kernel (k1): 162.755005 (us)
Average execution time of dense embedding kernel (k2): 202.652008 (us)
FAIL
GATE:SUM name=output_k1_dim2048 dtype=bytes algo=fnv1a64 value=b6432163258a811d nbytes=81920000
GATE:SUM name=output_k2_dim2048 dtype=bytes algo=fnv1a64 value=b6432163258a811d nbytes=81920000
GATE:SUM name=output_ref_dim2048 dtype=bytes algo=fnv1a64 value=bd6a87a56fcc67e3 nbytes=81920000

Embedding dimension: 12288
block size: 128
Average execution time of dense embedding kernel (k1): 337.427002 (us)
Average execution time of dense embedding kernel (k2): 247.468018 (us)
FAIL
block size: 256
Average execution time of dense embedding kernel (k1): 178.818008 (us)
Average execution time of dense embedding kernel (k2): 306.524017 (us)
FAIL
block size: 512
Average execution time of dense embedding kernel (k1): 206.349014 (us)
Average execution time of dense embedding kernel (k2): 225.840012 (us)
FAIL
block size: 1024
Average execution time of dense embedding kernel (k1): 189.582016 (us)
Average execution time of dense embedding kernel (k2): 290.566010 (us)
FAIL
GATE:SUM name=output_k1_dim12288 dtype=bytes algo=fnv1a64 value=ee10446316c574fa nbytes=491520000
GATE:SUM name=output_k2_dim12288 dtype=bytes algo=fnv1a64 value=ee10446316c574fa nbytes=491520000
GATE:SUM name=output_ref_dim12288 dtype=bytes algo=fnv1a64 value=8c3351a9b6f95795 nbytes=491520000
==PROF== Disconnected from process 941113
[941113] main@127.0.0.1
  nvkernel__Z18zero_device_bufferPfi_F1L39_2 (60000, 1, 1)x(128, 1, 1), Context 1, Stream 13, Device 0, CC 8.9
    Section: GPU Speed Of Light Throughput
    ----------------------- ----------- ------------
    Metric Name             Metric Unit Metric Value
    ----------------------- ----------- ------------
    DRAM Frequency                  Ghz         7.99
    SM Frequency                    Ghz         1.54
    Elapsed Cycles                cycle       169717
    Memory Throughput                 %        44.87
    DRAM Throughput                   %        44.87
    Duration                         us       109.89
    L1/TEX Cache Throughput           %        47.18
    L2 Cache Throughput               %        35.07
    SM Active Cycles              cycle    169815.42
    Compute (SM) Throughput           %        73.74
    ----------------------- ----------- ------------

    OPT   Compute is more heavily utilized than Memory: Look at the Compute Workload Analysis section to see what the   
          compute pipelines are spending their time doing. Also, consider whether any computation is redundant and      
          could be reduced or moved to look-up tables.                                                                  

  nvkernel__Z23dense_embedding_kernel1PKfS0_PfPKiiiii_F1L74_6 (8, 1, 1)x(160, 1, 1), Context 1, Stream 13, Device 0, CC 8.9
    Section: GPU Speed Of Light Throughput
    ----------------------- ----------- ------------
    Metric Name             Metric Unit Metric Value
    ----------------------- ----------- ------------
    DRAM Frequency                  Ghz         7.98
    SM Frequency                    Ghz         1.54
    Elapsed Cycles                cycle        19473
    Memory Throughput                 %         3.24
    DRAM Throughput                   %         1.64
    Duration                         us        12.64
    L1/TEX Cache Throughput           %        12.07
    L2 Cache Throughput               %         3.24
    SM Active Cycles              cycle      2158.46
    Compute (SM) Throughput           %         1.30
    ----------------------- ----------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.1 full      
          waves across all SMs. Look at Launch Statistics for more details.                                             

  nvkernel__Z18zero_device_bufferPfi_F1L39_2 (60000, 1, 1)x(128, 1, 1), Context 1, Stream 13, Device 0, CC 8.9
    Section: GPU Speed Of Light Throughput
    ----------------------- ----------- ------------
    Metric Name             Metric Unit Metric Value
    ----------------------- ----------- ------------
    DRAM Frequency                  Ghz         7.99
    SM Frequency                    Ghz         1.54
    Elapsed Cycles                cycle       169778
    Memory Throughput                 %        45.31
    DRAM Throughput                   %        45.31
    Duration                         us       109.95
    L1/TEX Cache Throughput           %        47.18
    L2 Cache Throughput               %        35.06
    SM Active Cycles              cycle    167662.71
    Compute (SM) Throughput           %        73.74
    ----------------------- ----------- ------------

    OPT   Compute is more heavily utilized than Memory: Look at the Compute Workload Analysis section to see what the   
          compute pipelines are spending their time doing. Also, consider whether any computation is redundant and      
          could be reduced or moved to look-up tables.                                                                  

  nvkernel__Z23dense_embedding_kernel2PKfS0_PfPKiiiii_F1L113_11 (8, 1, 1)x(160, 1, 1), Context 1, Stream 13, Device 0, CC 8.9
    Section: GPU Speed Of Light Throughput
    ----------------------- ----------- ------------
    Metric Name             Metric Unit Metric Value
    ----------------------- ----------- ------------
    DRAM Frequency                  Ghz         7.94
    SM Frequency                    Ghz         1.54
    Elapsed Cycles                cycle        20806
    Memory Throughput                 %         2.11
    DRAM Throughput                   %         2.11
    Duration                         us        13.54
    L1/TEX Cache Throughput           %        11.71
    L2 Cache Throughput               %         1.90
    SM Active Cycles              cycle      2288.04
    Compute (SM) Throughput           %         1.30
    ----------------------- ----------- ------------

    OPT   This kernel grid is too small to fill the available resources on this device, resulting in only 0.1 full      
          waves across all SMs. Look at Launch Statistics for more details.