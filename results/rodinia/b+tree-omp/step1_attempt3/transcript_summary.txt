**Changes**
- Rewrote `data_plan.md:1` into a full Strategy A data-management plan that lists every timed-region array, the per-kernel responsibility, the transfer schedule, and the critical checks so the GPU-resident copies stay steady across each `k`/`j` command.
- Updated `src/kernel/kernel_cpu.c:52` so that the GPU kernel caches the query key and the `knode` pointer for each level, guards each candidate against `knodes_elem`, and keeps the `target teams loop`/`target data` mapping semantics unchanged; the host fallback at `src/kernel/kernel_cpu.c:137` now mirrors those pointer caches so the serial path stays close to the offload version.
- Refined the range kernel at `src/kernel/kernel_cpu_2.c:94` to hoist `range_start/range_end`, cache the current/last node per level, and annotate the leaf scans with explicit pointer caching; each search now checks `knodes_elem` before updating offsets while remaining inside the existing `target data` region.

**Testing**
- `OMP_TARGET_OFFLOAD=MANDATORY timeout 300 make -f Makefile.nvc CC=nvc++ CLASS=C run > baseline_output.txt 2>&1` (baseline for comparison; executed before the code changes).
- `OMP_TARGET_OFFLOAD=MANDATORY timeout 300 make -f Makefile.nvc CC=nvc++ CLASS=C run > gpu_output.txt 2>&1` (new run reports `CPU Runtime: 0.005633s`, `GPU Runtime: 0.002316s` with the same implicit-`printf` warnings that appeared before).
- `diff baseline_output.txt gpu_output.txt` (exit 1 because instrumentation line numbers/timing changed—see around lines 241–341 for the loop-analysis comments and the final CPU/GPU runtime lines 341–342—these differences reflect the restructured kernels and slightly different timing rather than incorrect results).

Next steps:
1. Run the profiling step described under “Step 8” (CLASS B with the documented `nsys` command and `OMP_TARGET_OFFLOAD=MANDATORY`) to validate the new pointer-caching pattern on the GPU and uncover lingering hotspots.
2. If you ever need the textual outputs to match exactly, re-run `diff baseline_output.txt gpu_output.txt` after stabilizing the instrumentation (line-number comments/timings) so only functional differences remain visible.